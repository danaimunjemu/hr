<header class="flex py-4 px-4 sm:px-10 min-h-[70px] tracking-wide relative z-50 top-nav-header">
  <div class="nerd-top-header flex flex-wrap items-center justify-between gap-5 w-full">
    <div class="flex flex-col">

      <div class="top-nav-user-greeting">
        Hello {{ user()?.employee?.firstName }} {{ user()?.employee?.lastName }}
      </div>

      <div class="top-nav-time-greeting">
        {{ getGreeting() }}
      </div>

    </div>

    <div class="esg-score flex grow justify-center">
      <div class="flex esg-score-container">
        <div class="flex items-center" style="font-size: 14px; font-weight: 500; font-family: Orbitron, sans-serif">
          <!-- <span>ESG Score </span> -->
        </div>
        <div>
          <nz-select
  [(ngModel)]="selectedPortalValue"
  (ngModelChange)="onPortalChangeByValue($event)"
>
  @for (portal of portals; track portal.value) {
    <nz-option
      [nzValue]="portal"
      [nzLabel]="portal.label"
    />
  }
</nz-select>
        </div>
<!--        @if (!esgReport()) {-->
<!--          <nz-space nzSize="middle" class="ml-3">-->
<!--            <nz-skeleton-element-->
<!--              *nzSpaceItem-->
<!--              nzType="avatar"-->
<!--              [nzActive]="true"-->
<!--              [nzSize]="'small'"-->
<!--              [nzShape]="'circle'"-->
<!--            ></nz-skeleton-element>-->
<!--          </nz-space>-->
<!--          <nz-space nzSize="middle" class="ml-5">-->
<!--            <nz-skeleton-element-->
<!--              *nzSpaceItem-->
<!--              nzType="input"-->
<!--              [nzActive]="true"-->
<!--              [nzSize]="'small'"-->
<!--              style="width:50px"-->
<!--            ></nz-skeleton-element>-->
<!--          </nz-space>-->
<!--        }-->
<!--        @if (esgReport()) {-->
<!--          <div class="flex top-nav-esg-score">-->
<!--            <div class="top-nav-gauge-container">-->
<!--              <app-gauge-->
<!--                [name]="'ESG Score'"-->
<!--                [percent]="formattedTotalScore()"-->
<!--                [color]="chartColor">-->
<!--              </app-gauge>-->
<!--            </div>-->
<!--            <div class="flex items-center" style="font-size: 14px; font-weight: 500; font-family: Montserrat, sans-serif">-->
<!--              {{formattedTotalScore()}} %-->
<!--            </div>-->
<!--          </div>-->
<!--        }-->
        <!-- Score Here -->
      </div>


    </div>
    <span class="hidden max-md:block"><nz-page-header nzTitle="Nerdscore" ></nz-page-header></span>
    <div id="collapseMenu"
         class="max-lg:hidden lg:!block max-lg:before:fixed max-lg:before:bg-black max-lg:before:opacity-50 max-lg:before:inset-0 max-lg:before:z-50">
      <button id="toggleClose" class="lg:hidden fixed top-2 right-4 z-[100] rounded-full bg-white w-9 h-9 flex items-center justify-center border border-gray-200 cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-3.5 h-3.5 fill-black" viewBox="0 0 320.591 320.591">
          <path
            d="M30.391 318.583a30.37 30.37 0 0 1-21.56-7.288c-11.774-11.844-11.774-30.973 0-42.817L266.643 10.665c12.246-11.459 31.462-10.822 42.921 1.424 10.362 11.074 10.966 28.095 1.414 39.875L51.647 311.295a30.366 30.366 0 0 1-21.256 7.288z"
            data-original="#000000"></path>
          <path
            d="M287.9 318.583a30.37 30.37 0 0 1-21.257-8.806L8.83 51.963C-2.078 39.225-.595 20.055 12.143 9.146c11.369-9.736 28.136-9.736 39.504 0l259.331 257.813c12.243 11.462 12.876 30.679 1.414 42.922-.456.487-.927.958-1.414 1.414a30.368 30.368 0 0 1-23.078 7.288z"
            data-original="#000000"></path>
        </svg>
      </button>

      <div></div>
    </div>

    <div class="flex max-lg:ml-auto space-x-4">

      <div class="flex flex-row" style="margin-right: 0;">

        <div>
          <nerd-button
            [label]="'Search anything'"
            [disableButton]="false"
            [loading]="false"
            (click)="showModal()"
            [style]="'white'"
            [size]="'sm'"
            [icon]="'search'"
          />
        </div>


        <!-- TODO Notification Badge -->

        <!--        <div class="top-nav-button-icon" (click)="showPendingTasksModal()" nzTooltipTitle="Pending Tasks" nzTooltipPlacement="rightBottom" nz-tooltip>-->
        <!--          <nz-badge [nzCount]="5" nzSize="small">-->
        <!--          <span>-->
        <!--            <svg xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5"><path d="M15 2.5h-3c-4.478 0-6.718 0-8.109 1.391S2.5 7.521 2.5 12c0 4.478 0 6.718 1.391 8.109S7.521 21.5 12 21.5c4.478 0 6.718 0 8.109-1.391S21.5 16.479 21.5 12v-2"/><path stroke-linejoin="round" d="m8.5 10l3.5 3.5l9-10"/></g></svg>-->
        <!--          </span>-->
        <!--          </nz-badge>-->
        <!--        </div>-->




        <!-- <div class="top-nav-button-icon" routerLink="/app/esg-analysis/company-details" nzTooltipTitle="Account Settings" nzTooltipPlacement="rightBottom" nz-tooltip>
          <span>
            <svg xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" d="m21.318 7.141l-.494-.856c-.373-.648-.56-.972-.878-1.101c-.317-.13-.676-.027-1.395.176l-1.22.344c-.459.106-.94.046-1.358-.17l-.337-.194a2 2 0 0 1-.788-.967l-.334-.998c-.22-.66-.33-.99-.591-1.178c-.261-.19-.609-.19-1.303-.19h-1.115c-.694 0-1.041 0-1.303.19c-.261.188-.37.518-.59 1.178l-.334.998a2 2 0 0 1-.789.967l-.337.195c-.418.215-.9.275-1.358.17l-1.22-.345c-.719-.203-1.078-.305-1.395-.176c-.318.129-.505.453-.878 1.1l-.493.857c-.35.608-.525.911-.491 1.234c.034.324.268.584.736 1.105l1.031 1.153c.252.319.431.875.431 1.375s-.179 1.056-.43 1.375l-1.032 1.152c-.468.521-.702.782-.736 1.105s.14.627.49 1.234l.494.857c.373.647.56.971.878 1.1s.676.028 1.395-.176l1.22-.344a2 2 0 0 1 1.359.17l.336.194c.36.23.636.57.788.968l.334.997c.22.66.33.99.591 1.18c.262.188.609.188 1.303.188h1.115c.694 0 1.042 0 1.303-.189s.371-.519.59-1.179l.335-.997c.152-.399.428-.738.788-.968l.336-.194c.42-.215.9-.276 1.36-.17l1.22.344c.718.204 1.077.306 1.394.177c.318-.13.505-.454.878-1.101l.493-.857c.35-.607.525-.91.491-1.234s-.268-.584-.736-1.105l-1.031-1.152c-.252-.32-.431-.875-.431-1.375s.179-1.056.43-1.375l1.032-1.153c.468-.52.702-.781.736-1.105s-.14-.626-.49-1.234Z"/><path d="M15.52 12a3.5 3.5 0 1 1-7 0a3.5 3.5 0 0 1 7 0Z"/></g></svg>
          </span>
        </div> -->








        <div class="top-nav-button-icon" nzTooltipTitle="Log Out" nzTooltipPlacement="rightBottom" nz-tooltip (click)="logout()">
          <span>
            <svg xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15.5 8.04c-.041-1.16-.178-1.885-.636-2.453c-.653-.812-1.77-1.066-4.004-1.576l-1-.228c-3.395-.774-5.092-1.161-6.226-.27C2.5 4.405 2.5 6.126 2.5 9.568v4.864c0 3.442 0 5.164 1.134 6.055s2.83.504 6.225-.27l1.002-.228c2.233-.51 3.35-.764 4.003-1.576c.458-.567.595-1.293.636-2.453m3-6.948s3 2.21 3 3s-3 3-3 3m2.5-3H8.5"/></svg>
          </span>
        </div>
        

        

      </div>
      <button id="toggleOpen" class="lg:hidden cursor-pointer">
        <svg class="w-7 h-7" fill="#000" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd"
                d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                clip-rule="evenodd"></path>
        </svg>
      </button>
    </div>
  </div>
</header>


<nz-modal
  [(nzVisible)]="isVisible"
  [nzTitle]="modalTitle"
      [nzContent]="modalContent"
      [nzFooter]="modalFooter"
  [nzWidth]="760"
  (nzOnCancel)="handleCancel()">
  <ng-template #modalTitle>Custom Modal Title</ng-template>

      <ng-template #modalContent>
        <div class="modal-search">
    <nz-input-group [nzPrefix]="searchIcon">
      <input
        #searchInput
        nz-input
        placeholder="Search pages, modules, and actions..."
        [(ngModel)]="searchTerm"
        (ngModelChange)="onSearchChange($event)" />
    </nz-input-group>
    <ng-template #searchIcon>
      <span nz-icon nzType="search"></span>
    </ng-template>
  </div>

  <div class="search-hint">Use Ctrl/Cmd + K to open, arrows to navigate, Enter to open.</div>

  <nz-list *ngIf="searchResults.length; else emptySearchState" nzSize="small" class="search-results">
    <nz-list-item
      *ngFor="let item of searchResults; let i = index"
      [class.active]="i === activeIndex"
      (mouseenter)="activeIndex = i"
      (click)="navigate(item.path)">
      <nz-list-item-meta [nzTitle]="item.name" [nzDescription]="item.description"></nz-list-item-meta>
      <div class="search-path">{{ item.path }}</div>
    </nz-list-item>
  </nz-list>

  <ng-template #emptySearchState>
    <div class="search-empty">
      <span *ngIf="!searchTerm">Start typing to search the application.</span>
      <span *ngIf="searchTerm">No matching pages found.</span>
    </div>
  </ng-template>
      </ng-template>

      <ng-template #modalFooter>
      </ng-template>
  
</nz-modal>
