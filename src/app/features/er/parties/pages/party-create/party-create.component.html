<div class="page-header">
  <h1 class="text-2xl font-bold mb-4">Add Party to Case</h1>
</div>

<nz-card>
  <form nz-form [formGroup]="form" (ngSubmit)="submit()" nzLayout="vertical">
    
    <div nz-row [nzGutter]="24">
      <div nz-col [nzSpan]="12">
        <nz-form-item>
          <nz-form-label nzRequired>Linked Case</nz-form-label>
          <nz-form-control nzErrorTip="Select a case">
            <nz-select formControlName="erCase" nzShowSearch nzAllowClear nzPlaceHolder="Select case">
              <nz-option *ngFor="let c of cases()" [nzValue]="c.id" [nzLabel]="(c.caseNumber || 'ID ' + c.id) + ': ' + c.title"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </div>
      <div nz-col [nzSpan]="12">
        <nz-form-item>
          <nz-form-label nzRequired>Role</nz-form-label>
          <nz-form-control nzErrorTip="Select role">
            <nz-select formControlName="role" nzPlaceHolder="Select role">
              <nz-option nzValue="WITNESS" nzLabel="Witness"></nz-option>
              <nz-option nzValue="COMPLAINANT" nzLabel="Complainant"></nz-option>
              <nz-option nzValue="RESPONDENT" nzLabel="Respondent"></nz-option>
              <nz-option nzValue="INVESTIGATOR" nzLabel="Investigator"></nz-option>
              <nz-option nzValue="REPRESENTATIVE" nzLabel="Representative"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>

    <div nz-row [nzGutter]="24">
      <div nz-col [nzSpan]="8">
        <nz-form-item>
          <nz-form-label nzRequired>Person Type</nz-form-label>
          <nz-form-control>
            <nz-radio-group formControlName="personType">
              <label nz-radio nzValue="EMPLOYEE">Employee</label>
              <label nz-radio nzValue="EXTERNAL">External</label>
            </nz-radio-group>
          </nz-form-control>
        </nz-form-item>
      </div>
      
      <div nz-col [nzSpan]="16">
        <nz-form-item *ngIf="form.get('personType')?.value === 'EMPLOYEE'">
          <nz-form-label nzRequired>Employee</nz-form-label>
          <nz-form-control nzErrorTip="Select employee">
            <nz-select formControlName="employee" nzShowSearch nzAllowClear nzPlaceHolder="Select employee">
              <nz-option *ngFor="let emp of employees()" [nzValue]="emp.id" [nzLabel]="emp.firstName + ' ' + emp.lastName"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>

        <nz-form-item *ngIf="form.get('personType')?.value === 'EXTERNAL'">
          <nz-form-label nzRequired>External Name</nz-form-label>
          <nz-form-control nzErrorTip="Enter name">
            <input nz-input formControlName="externalName" placeholder="e.g. Jane Doe (Vendor)" />
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>

    <nz-form-item>
      <nz-form-label>Notes</nz-form-label>
      <nz-form-control>
        <textarea nz-input formControlName="notes" rows="4" placeholder="Additional details..."></textarea>
      </nz-form-control>
    </nz-form-item>

    <div class="flex justify-end gap-2">
      <button nz-button type="button" (click)="cancel()">Cancel</button>
      <button nz-button nzType="primary" type="submit" [nzLoading]="loading()">Add Party</button>
    </div>
  </form>
</nz-card>
