<div class="page-header">
  <h1 class="text-2xl font-bold mb-4">Log New Intake</h1>
</div>

<nz-card>
  <form nz-form [formGroup]="form" (ngSubmit)="submit()" nzLayout="vertical">
    
    <div nz-row [nzGutter]="24">
      <div nz-col [nzSpan]="12">
        <nz-form-item>
          <nz-form-label nzRequired>Linked Case</nz-form-label>
          <nz-form-control nzErrorTip="Select a case">
            <nz-select formControlName="erCase" nzShowSearch nzAllowClear nzPlaceHolder="Select case">
              <nz-option *ngFor="let c of cases()" [nzValue]="c.id" [nzLabel]="(c.caseNumber || 'ID ' + c.id) + ': ' + c.title"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </div>
      <div nz-col [nzSpan]="12">
        <nz-form-item>
          <nz-form-label nzRequired>Logged By</nz-form-label>
          <nz-form-control nzErrorTip="Select logger">
            <nz-select formControlName="loggedBy" nzShowSearch nzAllowClear nzPlaceHolder="Select employee">
              <nz-option *ngFor="let emp of employees()" [nzValue]="emp.id" [nzLabel]="emp.firstName + ' ' + emp.lastName"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>

    <div nz-row [nzGutter]="24">
      <div nz-col [nzSpan]="8">
        <nz-form-item>
          <nz-form-label nzRequired>Incident Date (From)</nz-form-label>
          <nz-form-control nzErrorTip="Required">
            <nz-date-picker formControlName="incidentDateFrom" nzShowTime style="width: 100%"></nz-date-picker>
          </nz-form-control>
        </nz-form-item>
      </div>
      <div nz-col [nzSpan]="8">
        <nz-form-item>
          <nz-form-label>Incident Date (To)</nz-form-label>
          <nz-form-control>
            <nz-date-picker formControlName="incidentDateTo" nzShowTime style="width: 100%"></nz-date-picker>
          </nz-form-control>
        </nz-form-item>
      </div>
      <div nz-col [nzSpan]="8">
        <nz-form-item>
          <nz-form-label nzRequired>Location</nz-form-label>
          <nz-form-control nzErrorTip="Enter location">
            <input nz-input formControlName="incidentLocation" placeholder="Office, Remote, etc." />
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>

    <nz-form-item>
      <nz-form-label nzRequired>Detailed Description</nz-form-label>
      <nz-form-control nzErrorTip="Enter details">
        <textarea nz-input formControlName="detailedDescription" rows="6" placeholder="What happened?"></textarea>
      </nz-form-control>
    </nz-form-item>

    <div class="flex justify-end gap-2">
      <button nz-button type="button" (click)="cancel()">Cancel</button>
      <button nz-button nzType="primary" type="submit" [nzLoading]="loading()">Log Intake</button>
    </div>
  </form>
</nz-card>
