<div class="dashboard-container">
  <!-- Header -->
  <div class="mb-6">
    <h1 class="text-2xl font-bold text-gray-800">HR Dashboard</h1>
    <p class="text-gray-500">Overview of your organization's metrics</p>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading()" class="flex justify-center items-center h-64">
    <nz-spin nzSimple nzSize="large"></nz-spin>
  </div>

  <div *ngIf="!loading()">
    <!-- Top Cards (Preserved) -->
    <div nz-row [nzGutter]="16" class="mb-6">
      <div nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8">
        <nz-card class="top-card">
          <nz-statistic
            [nzValue]="totalEmployees()"
            [nzTitle]="'Total Employees'"
            [nzPrefix]="prefixTplUser"
            [nzValueStyle]="{ color: '#3F8600' }"
          ></nz-statistic>
          <ng-template #prefixTplUser><span nz-icon nzType="team"></span></ng-template>
        </nz-card>
      </div>
      <div nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8">
        <nz-card class="top-card">
          <nz-statistic
            [nzValue]="safetyIncidentsCount()"
            [nzTitle]="'Safety Incidents'"
            [nzPrefix]="prefixTplSafety"
            [nzValueStyle]="{ color: '#CF1322' }"
          ></nz-statistic>
          <ng-template #prefixTplSafety><span nz-icon nzType="alert"></span></ng-template>
        </nz-card>
      </div>
      <div nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8">
        <nz-card class="top-card">
          <nz-statistic
            [nzValue]="erCasesCount()"
            [nzTitle]="'Active ER Cases'"
            [nzPrefix]="prefixTplEr"
            [nzValueStyle]="{ color: '#FAAD14' }"
          ></nz-statistic>
          <ng-template #prefixTplEr><span nz-icon nzType="audit"></span></ng-template>
        </nz-card>
      </div>
    </div>

    <!-- Row 1: Employment Status & OHS Incidents -->
    <div nz-row [nzGutter]="24" class="mb-6">
      <div nz-col [nzXs]="24" [nzLg]="12">
        <nz-card nzTitle="Employment Status Distribution" class="custom-card">
          <div #barContainer class="chart-container"></div>
        </nz-card>
      </div>
      <div nz-col [nzXs]="24" [nzLg]="12">
        <nz-card nzTitle="OHS Incidents Breakdown" class="custom-card">
          <div #donutContainer class="chart-container"></div>
        </nz-card>
      </div>
    </div>

    <!-- Row 2: Trends & Heatmap -->
    <div nz-row [nzGutter]="24" class="mb-6">
      <div nz-col [nzXs]="24" [nzLg]="12">
        <nz-card nzTitle="Trends Over Time (Monthly)" class="custom-card">
          <div #lineContainer class="chart-container"></div>
        </nz-card>
      </div>
      <div nz-col [nzXs]="24" [nzLg]="12">
        <nz-card nzTitle="Time & Attendance Heatmap" class="custom-card">
          <div #heatmapContainer class="chart-container"></div>
        </nz-card>
      </div>
    </div>

    <!-- Row 3: Tables -->
    <div nz-row [nzGutter]="24">
      <div nz-col [nzXs]="24" [nzLg]="14">
        <nz-card nzTitle="Recent Activities" class="custom-card">
          <nz-table #recentTable [nzData]="recentActivities" [nzShowPagination]="false" nzSize="small">
            <thead>
              <tr>
                <th>Module</th>
                <th>Description</th>
                <th>Status</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of recentTable.data">
                <td><nz-tag [nzColor]="'blue'">{{ item.module }}</nz-tag></td>
                <td>{{ item.description }}</td>
                <td>
                  <nz-tag [nzColor]="item.status === 'Completed' || item.status === 'Approved' ? 'success' : (item.status === 'New' ? 'processing' : 'warning')">
                    {{ item.status }}
                  </nz-tag>
                </td>
                <td class="text-gray-500 text-xs">{{ item.date }}</td>
              </tr>
            </tbody>
          </nz-table>
        </nz-card>
      </div>
      <div nz-col [nzXs]="24" [nzLg]="10">
        <nz-card nzTitle="Upcoming Events" class="custom-card">
          <nz-table #eventsTable [nzData]="upcomingEvents" [nzShowPagination]="false" nzSize="small">
            <thead>
              <tr>
                <th>Event</th>
                <th>Type</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let event of eventsTable.data">
                <td class="font-medium">{{ event.title }}</td>
                <td><nz-tag [nzColor]="'purple'">{{ event.type }}</nz-tag></td>
                <td>{{ event.date }}</td>
              </tr>
            </tbody>
          </nz-table>
        </nz-card>
      </div>
    </div>

  </div>
</div>
